# 流程图：
- 0 游客
  - 0.1 游客注册
    - 业务流图
![0-1游客注册-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/0-1%E6%B8%B8%E5%AE%A2%E6%B3%A8%E5%86%8C-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![0-1游客注册-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/0-1%E6%B8%B8%E5%AE%A2%E6%B3%A8%E5%86%8C-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)

  - 0.2 游客登录
    - 业务流图
![0-2游客登录-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/0-2%E6%B8%B8%E5%AE%A2%E7%99%BB%E5%BD%95-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![0-2游客登录-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/0-2%E6%B8%B8%E5%AE%A2%E7%99%BB%E5%BD%95-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)
    

- 1 顾客
  - 1.1 顾客查询图书
    - 业务流图
![1-1顾客查询图书-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/1-1%E9%A1%BE%E5%AE%A2%E6%9F%A5%E8%AF%A2%E5%9B%BE%E4%B9%A6-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![1-1顾客查询图书-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/1-1%E9%A1%BE%E5%AE%A2%E6%9F%A5%E8%AF%A2%E5%9B%BE%E4%B9%A6-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)

  - 1.2 顾客购买图书
    - 业务流图
![1-2顾客购买图书-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/1-2%E9%A1%BE%E5%AE%A2%E8%B4%AD%E4%B9%B0%E5%9B%BE%E4%B9%A6-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![1-2顾客购买图书-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/1-2%E9%A1%BE%E5%AE%A2%E8%B4%AD%E4%B9%B0%E5%9B%BE%E4%B9%A6-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)


- 2 销售人员
  - 2.1 销售人员查询图书
    - 业务流图
![2-1销售人员查询图书-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-1%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E6%9F%A5%E8%AF%A2%E5%9B%BE%E4%B9%A6-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![2-1销售人员查询图书-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-1%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E6%9F%A5%E8%AF%A2%E5%9B%BE%E4%B9%A6-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)

  - 2.2 销售人员查询图书
    - 业务流图
![2-2销售人员购买图书-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-2%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E8%B4%AD%E4%B9%B0%E5%9B%BE%E4%B9%A6-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![2-2销售人员购买图书-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-2%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E8%B4%AD%E4%B9%B0%E5%9B%BE%E4%B9%A6-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)

  - 2.3 销售人员进货
    - 业务流图
![2-3销售人员进货-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-3%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E8%BF%9B%E8%B4%A7-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![2-3销售人员进货-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-3%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E8%BF%9B%E8%B4%A7-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)

  - 2.4 销售人员图书信息录入
    - 业务流图
![2-4销售人员录入图书信息-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-4%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E5%BD%95%E5%85%A5%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![2-4销售人员录入图书信息-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-4%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E5%BD%95%E5%85%A5%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)

  - 2.5 销售人员图书信息修改
    - 业务流图
![2-5销售人员修改图书信息-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-5%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E4%BF%AE%E6%94%B9%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![2-5销售人员修改图书信息-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-5%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E4%BF%AE%E6%94%B9%E5%9B%BE%E4%B9%A6%E4%BF%A1%E6%81%AF-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)

  - 2.6 销售人员创建用户
    - 业务流图
![2-6销售人员创建用户-业务流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-6%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7-%E4%B8%9A%E5%8A%A1%E6%B5%81%E5%9B%BE.png)
    - 数据流图
![2-6销售人员创建用户-数据流图.png](%E6%B5%81%E7%A8%8B%E5%9B%BE/2-6%E9%94%80%E5%94%AE%E4%BA%BA%E5%91%98%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE.png)


- 3 店长
    - 3.1 销售人员的所有操作。
      - 业务流图和数据流图都同上，除了不录入销售人员操作信息库，但是注意依然录入图书信息库和收支信息库。
    - 3.2 查询某段时间的采购信息
      - 业务流图：店长→销售人员操作信息库。
      - 数据流图：店长输入查询请求→销售人员操作信息库返回对应时间段下的采购信息。
    - 3.3 查询某段时间的销售情况
      - 业务流图：店长→收支信息库。
      - 数据流图：店长输入查询请求→收支信息库返回对应时间段下的销售信息。
    - 3.4 查询某段时间的盈利情况
      - 业务流图：店长→收支信息库。
      - 数据流图：店长输入查询请求→收支信息库计算并返回对应时间段下的盈利情况。
    - 3.5 查看各员工的工作情况报告
      - 业务流图：店长→销售人员操作信息库。
      - 数据流图：店长输入想查询的员工账号→销售人员操作信息库返回其所有操作记录。
    - 3.6 查看系统日志（注：以上所有任何账户操作记录均传入系统日志）
      - 业务流图：店长→系统日志。
      - 数据流图：店长查询系统日志→系统日志返回所有历史信息。


# 数据词典
- 账户：包含类型、用户名、密码这3条信息。账户的集合是**用户信息库**。
- 图书：包含ISBN 号（20 个字符，每本正版书都有惟一的标识）、书名（60 个字符、作者（60 个字符）、关键字（可以有多个，总共不超过 60 个字符）、库存量（整型）、单价（非负实数）。图书的集合是**图书信息库**。
- 操作信息：【时间】【用户类型】【用户名】【操作】
- 系统日志：记录所有操作者的所有操作信息。
- 销售人员操作信息库：对每个{销售人员,vector<行为>}构建键值对储存，是一个unordered_map。
- 收支信息库:对每次购买图书/进货的金额进行记录，存储为【时间】【售出/买进】【图书ISBN】【本数】【单价】【总金额】


# 功能说明
- 图书:
  - 包含信息：ISBN 号（20 个字符，每本正版书都有惟一的标识）、书名（60 个字符、作者（60 个字符）、关键字（可以有多个，总共不超过 60 个字符）、库存量（整型）、单价（非负实数）。
  - 修改任意信息函数：输入为信息类型和内容。

- 图书信息库：
  - 包含信息：unordered_map<ISBN号, 图书>
  - 修改单本单项信息函数：输入为ISBN号、信息类型和内容。（其中调用了“图书”的函数）
  - 搜索图书函数：输入为图书信息的任意组合，输出符合的图书的全部信息。（通过遍历查找）

- 操作记录：
  - 包含信息：【时间】【用户类型】【用户名】【操作（string）】
  - 构造新操作函数。输入以上信息。
  
- 销售人员操作信息库：
  - 包含信息：unordered_map<销售人员账户, vector<操作记录>>
  - 添加单条操作信息函数：输入人员和操作。
  - 打印函数：按顺序打印所有操作记录。

- 收支信息库：
  - 包含信息：vector<【时间】【售出/买进】【图书ISBN】【本数】【单价】【总金额】>
  - 添加单条收支信息函数：输入【时间】【售出/买进】【图书ISBN】【本数】。
  - 打印盈利函数：计算并输出某段时间盈利。
  - 打印进货函数：打印进货记录。
  - 打印销售函数：打印销售记录。

- 系统日志
  - 包含信息：vector<操作记录>。
  - 添加操作函数：输入【时间】【用户类型】【用户名】【操作（string）】，调用“构造新操作函数”并存储。**（在所有输入后必定执行该操作）**
  - 打印函数：按顺序打印所有操作记录。

- 顾客：
  - 顾客查询图书函数：输入ISBN 号、作者名字、关键字、书名中的任意组合。调用图书信息库的“搜索图书函数”。
  - 顾客购买图书。
    - 输入：ISBN 号和购买数量。
    - 输出：向各个库更新信息，并打印“购买成功！”

- 销售人员（顾客类的衍生）
  - 顾客操作函数。调用顾客类函数，并将操作记录存入各个库。
  - 进货函数。调用图书信息库“修改单本单项信息函数”，并将操作记录存入各个库。
  - 录入信息函数：调用图书构造函数和图书信息库新增函数，并存储操作记录。
  - 修改信息函数：调用图书信息库“修改单本单项信息函数”，并存储操作记录。
  - 新开账户函数：输入用户类型、用户名、密码。根据类型构造账户实例。

- 店长（销售人员类的衍生）
  - 销售人员操作函数：调用销售人员类函数，并将操作记录存入各个库。
  - 查看各种信息的函数：调用各个库的全部打印的函数。

# 用户交互设计
    - 请设计所有的命令格式和对应的输出；
- 创建账户：CREATE <account_type> <user_name> <password>
  - 创建账户成功输出：Successfully create account!
  - 创建账户失败输出：Invalid account type! / Invalid username! / Invalid password!
- 登入账户：LOGIN <user_name> <password>
  - 登录账户成功输出：Successfully login!
  - 登录账户失败输出：Invalid username! / Wrong password!
- 查询图书：SEARCH <ISBN> <title> <writer> <keyword>。其中无该类信息请写void。
  - 查询打表格式：<ISBN> <title> <writer> <keyword> <stock_count> <price>。若无直接输出No matching information!
- 购买图书：BUY <ISBN> <pieces>.
  - 购买成功：Successful purchase!
  - 购买失败：Invalid ISBN! / Book short of stock! Remaining stock: <stock_count> / Invalid purchase number! 
- 进货：RESTOCK <ISBN> <number> <price>.
  - 购买成功：Successfully restock!
  - 购买失败：Invalid ISBN! / Invalid restock number! / Invalid restock price! 
- 录入新书信息：NEW <ISBN> <title> <writer> <keyword> <price>.其中新书录入库存默认为0.
  - 录入失败：ISBN already exist!
- 修改图书信息：MODIFY <ISBN> <data_type> <new_data>.
  - 修改失败：Invalid ISBN! / Invalid data type! / Invalid data! / 其中允许新信息和旧信息相同。
- 查询某段时间的采购信息：INQUIRE PURCHASE.
  - 输出：<ISBN> <number> <price>.打表
- 查询某段时间的采购信息：INQUIRE SALE.
  - 输出：<ISBN> <number> <price>.打表
- 查询某段时间的盈利：INQUIRE PROFIT
  - 输出：先打表【时间】【售出/买进】【图书ISBN】【本数】【单价】【总金额】，再输出一个总和的<profit_number>。
- 查看某员工的工作情况：INQUIRE STAFF
  - 输出：<time> <operation_type> <operation>。